////////////////////////////////////////////////////////////////////////////////
///
/// @file   $FILE$
/// @author $AUTHOR$
/// @date   $DATE$
/// @brief  Source code file for defining hardware operation.   
///
////////////////////////////////////////////////////////////////////////////////

// *****************************************************************************
// ************************** System Include Files *****************************
// *****************************************************************************
#include <xc.h>
#include <stdbool.h>
#include <stddef.h>
#include <stdint.h>

// *****************************************************************************
// ************************** User Include Files *******************************
// *****************************************************************************
#include "ver.h"
#include "can.h"

// *****************************************************************************
// ************************** Defines ******************************************
// *****************************************************************************

// *****************************************************************************
// ************************** Global Variable Definitions **********************
// *****************************************************************************

// *****************************************************************************
// ************************** File-Scope Variable Definitions ******************
// *****************************************************************************
static const uint8_t  node_type     = 1;    // Identified as 'Servo' Node.
static const uint8_t  rev_ver       = 0;
static const uint8_t  min_ver       = 0;
static const uint8_t  maj_ver       = 0;
static const uint32_t serial_num    = 0;    // Updated during manufacturing.

// *****************************************************************************
// ************************** Function Prototypes ******************************
// *****************************************************************************

// *****************************************************************************
// ************************** Global Functions *********************************
// *****************************************************************************

// *****************************************************************************
// ************************** Static Functions *********************************
// *****************************************************************************
void VerService ( void )
{
    CAN_TX_NODE_VER_U version_msg;
    
    // Construct the Version CAN message.
    version_msg.node_type  = node_type;
    version_msg.rev_ver    = rev_ver;
    version_msg.min_ver    = min_ver;
    version_msg.maj_ver    = maj_ver;
    version_msg.serial_num = serial_num;

    // Send the Version message.
    CANTxSet ( CAN_TX_MSG_NODE_VER, version_msg.data_u16 );
}